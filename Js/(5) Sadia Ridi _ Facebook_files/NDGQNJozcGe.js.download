if (self.CavalryLogger) { CavalryLogger.start_js(["urdTkys"]); }

__d("MWListCell.bs",[],(function(a,b,c,d,e,f){"use strict";var g={};function a(a){return a}function b(a){return a}function c(a){return a}function d(a){return a}function e(a){return a}function h(a){return a}function i(a){return a}a={body:a,$$switch:b,checkbox:c,expander:d,icon:e,disclosure:h,secondaryButton:i};f.PrimaryAddOn=g;f.SecondaryAddOn=a}),null);
__d("MWInboxInfoBlockMessages.bs",["fbt","CometLazyDialogTrigger.react","FBID.bs","JSResourceForInteraction","LSContactBlockedByViewerStatus.bs","LsMessengerThreadDamagingActionsSourceOwner","ReQL.bs","ReQLSubscription.bs","ReStore.bs","SkytaleDB","bs_caml_int64","bs_curry","bs_int64","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||b("react");function a(a){var c=a.contactId,d=a.children,e=a.loggingEntryPoint;a=a.loggingSource;var f=b("ReStore.bs").useHook(void 0),h=b("ReQLSubscription.bs").useFirst(i.useMemo(function(){return b("ReQL.bs").getKeyRange(b("SkytaleDB").table(f,"contacts").asc,{hd:c,tl:0})},[f,JSON.stringify(c)])),j=h!==void 0?b("bs_caml_int64").eq(h.n,b("LSContactBlockedByViewerStatus.bs").messageBlocked):!1,k=h!==void 0?b("bs_caml_int64").eq(h.n,b("LSContactBlockedByViewerStatus.bs").fullyBlocked):!1,l=j||k?g._("Unblock"):g._("Block");if(h!==void 0)return i.jsx(b("CometLazyDialogTrigger.react"),{dialogResource:b("JSResourceForInteraction")("MWChatBlockActionDialog",{name:"MWChatBlockActionDialog","class":"fluid"}).__setRef("MWInboxInfoBlockMessages.bs"),dialogProps:{targetFBID:b("FBID.bs").ofStringExn(b("bs_int64").to_string(c)),threadFBID:b("FBID.bs").ofStringExn(b("bs_int64").to_string(c)),onClose:function(a){},loggingData:{entryPoint:e,requestId:void 0,source:a,sourceOwner:b("LsMessengerThreadDamagingActionsSourceOwner").MCI}},children:function(a,c){return b("bs_curry")._3(d,a,c,l)}});else return null}c=a;f.make=c}),null);
__d("MWChatTabContentNew.bs",["MWChatComposer.bs","MWChatComposerMediaDropTarget.bs","MWChatComposerMessageRequestInfoText.bs","MWChatTabContent.bs","MWChatThread.bs","MWChatUserComposer.bs","MWTheme.bs","MWUIThreadEmoji.bs","bs_caml_option","bs_curry","react","stylex"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react");function j(a){var c=a.id,d=a.items,e=a.dispatch,f=a.closeTab,g=a.otherUserFbid,j=a.customLikeEmoji,k=a.isTabFocused,l=a.hasContent,m=a.repliedToMessage,n=a.buildSharedMediaViewerURL,o=a.closeReplyPreview,p=a.onSendMessage,q=a.isOptimisticThread;a=a.isLoading;var r=q!==void 0?q:!1;q=a!==void 0?a:!1;var s=b("MWTheme.bs").useTheme(void 0);a=i.useRef(0);var t=i.useState(function(){return!1}),u=t[1],v=t[0];t=i.useRef(null);var w=i.useRef(null),x=i.useRef(null),y;y=s.TAG===0?void 0:{backgroundImage:b("MWTheme.bs").gradient(void 0,void 0,s._0.colors)};return i.jsx(i.Fragment,{children:i.jsx("div",{className:(h||(h=b("stylex")))(b("MWChatTabContent.bs").styles.main),children:i.jsxs(b("MWChatComposerMediaDropTarget.bs").make,{children:[i.jsx("div",{className:h(b("MWChatTabContent.bs").styles.thread),style:y,children:i.jsx(b("MWChatThread.bs").make,{id:c,items:d,hasMoreMessages:!1,isScrolledToBottomRef:a,dispatch:e,spacerRef:w,scrollerRef:t,buildSharedMediaViewerURL:n,forceContextBanner:!q})}),i.jsx("div",{className:h(b("MWChatTabContent.bs").styles.composer),children:i.jsx(b("MWChatUserComposer.bs").make,{threadId:c,chatComposer:function(a){return i.jsx(b("MWChatComposer.bs").make,{color:b("MWTheme.bs").bottom(s),otherUserFbid:g,isPreviewThread:!0,isOptimisticThread:r,customLikeEmoji:j,isTabFocused:k,shouldShowMenu:!1,hasContent:l,repliedToMessage:m,actionTrayOpen:v,closeActionTray:function(a){return b("bs_curry")._1(u,function(a){return!1})},openActionTray:function(a){return b("bs_curry")._1(u,function(a){return!0})},fileUploadHandlerRef:x,messageRequestInfoText:i.jsx(b("MWChatComposerMessageRequestInfoText.bs").make,{closeTab:function(a){},size:"large"}),closeReplyPreview:o,openTabFromPreview:function(a){return e("OpenTabFromPreview")},closeTab:f,onSendMessage:p})}})})],disabled:!1,fileUploadHandlerRef:x,xstyle:b("MWChatTabContent.bs").styles.dropTarget})})})}c={make:j};function a(a){var c=a.id,d=a.isTabFocused,e=a.dispatch,f=a.closeTab,g=a.messages,h=a.hasContent,k=a.changeRepliedToMessage,l=a.repliedToMessage,m=a.buildSharedMediaViewerURL,n=a.closeReplyPreview,o=a.onSendMessage,p=a.isOptimisticThread;a=a.isLoading;p=p!==void 0?p:!1;a=a!==void 0?a:!1;var q;if(typeof c==="string")q=void 0;else{var r=c.NAME;q=r==="User"||r==="Page"?b("bs_caml_option").some(c.VAL):void 0}r=b("bs_curry")._1(b("MWUIThreadEmoji.bs").useEmoji,void 0);var s=function(a){if(typeof a==="string"||a.NAME!=="ClickReplyTo")return e(a);else return b("bs_curry")._1(k,a.VAL)};return i.jsx(j,{id:c,items:g,dispatch:s,closeTab:f,otherUserFbid:q,customLikeEmoji:r,isTabFocused:d,hasContent:h,repliedToMessage:l,buildSharedMediaViewerURL:m,closeReplyPreview:n,onSendMessage:o,isOptimisticThread:p,isLoading:a})}d=b("MWChatTabContent.bs").styles;e=a;f.styles=d;f.Inner=c;f.make=e}),null);
__d("MWChatTabNew.bs",["CometPlaceholder.react","LSMailboxMessagesRangeQueryDirection.bs","MWChatComposer.bs","MWChatComposerMediaDropTarget.bs","MWChatConnectionStatusCard.bs","MWChatLoadMoreItemsIncrementally.bs","MWChatTabContentNew.bs","MWChatTabContentStyles.bs","MWLSFetchMessagesPage.bs","MWLSThreadHasMoreMessages.bs","MWTheme.bs","MWThreadKey.bs","MWThread_DEPRECATED.bs","MWUIChatTabState.bs","MWUIChatThreadHook.bs","MWUILoadThreadMessages.bs","MWUIRepliedToMessage.bs","MWUITheme.bs","XCometMessengerMediaControllerRouteBuilder","XCometMessengerPhotoControllerRouteBuilder","bs_belt_Option","bs_caml_option","bs_curry","react","recoverableViolation","stylex","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react");function j(a){var c=a.hasContent,d=a.isTabFocused,e=a.openTabForGroup;a=function(a){if(typeof a==="string"||a.NAME!=="Group"){b("recoverableViolation")("expected group","messenger_web_product");return}else return b("bs_curry")._1(e,a.VAL)};var f=i.useRef(null);return i.jsx("div",{className:(h||(h=b("stylex")))(b("MWChatTabContentStyles.bs").styles.main),children:i.jsxs(b("MWChatComposerMediaDropTarget.bs").make,{children:[i.jsx("div",{className:h(b("MWChatTabContentStyles.bs").styles.thread)}),i.jsx("div",{className:h(b("MWChatTabContentStyles.bs").styles.composer),children:i.jsx(b("MWChatComposer.bs").make,{color:b("MWTheme.bs").bottom(b("MWTheme.bs").$$default),otherUserFbid:void 0,isPreviewThread:!0,customLikeEmoji:void 0,isTabFocused:d,shouldShowMenu:!1,hasContent:c,repliedToMessage:void 0,actionTrayOpen:!1,closeActionTray:function(a){},openActionTray:function(a){},fileUploadHandlerRef:f,closeReplyPreview:function(a){},openTabFromPreview:function(a){},closeTab:function(a){},onSendMessage:a})})],disabled:!1,fileUploadHandlerRef:f,xstyle:b("MWChatTabContentStyles.bs").styles.dropTarget})})}c={make:j};function k(a){var c=a.threadId;a=a.children;b("bs_curry")._1(b("MWUIChatThreadHook.bs").useThread,c);return a}d={make:k};function l(a){var c=a.isTabFocused,d=a.hasContent,e=a.openTabForGroup,f=a.openTabForUser,g=a.openTabForPage;a=a.isOptimisticThread;a=a!==void 0?a:!1;var h=b("MWThread_DEPRECATED.bs").useIdExn(void 0),j=b("bs_curry")._1(b("MWUIRepliedToMessage.bs").useCurrentlyRepliedToMessage,void 0),k=j[2],l=function(a){var c=a.NAME;if(c==="Group")return b("bs_curry")._1(e,a.VAL);else if(c==="Page")return b("bs_curry")._1(g,a.VAL);else if(c==="User")return b("bs_curry")._1(f,a.VAL);else return b("unrecoverableViolation")("Not supported","messenger_web_product")},m=function(a,c){if(c)return b("XCometMessengerPhotoControllerRouteBuilder").buildURL({photo_ids:a.photo_ids,fbid:a.fbid,message_id:a.message_id});else return b("XCometMessengerMediaControllerRouteBuilder").buildURL({thread_id:h.VAL,attachment_id:a.fbid,message_id:a.message_id})},n=i.useState(function(){}),o=n[1];n=b("MWChatLoadMoreItemsIncrementally.bs").useLoadMore(void 0,void 0,void 0,b("bs_curry")._3(b("MWUILoadThreadMessages.bs").useMessageItems,void 0,0,void 0),b("MWLSFetchMessagesPage.bs").useFetchMessagesPage(void 0),b("MWLSThreadHasMoreMessages.bs").useThreadHasMoreMessages(void 0));var p=n[2],q=n[1];n=n[0];var r=[{NAME:"Messages",VAL:n}],s=n.length;n=p&&s<10;var t=b("bs_curry")._1(b("MWUITheme.bs").useTheme,void 0);i.useEffect(function(){p&&s<10&&b("bs_curry")._1(q,b("LSMailboxMessagesRangeQueryDirection.bs").before)},[s,p,q]);return i.jsx(b("CometPlaceholder.react"),{children:i.jsx(b("MWTheme.bs").provider,{theme:t,children:i.jsx(b("MWChatTabContentNew.bs").make,{id:h,isTabFocused:c,dispatch:function(a){if(typeof a==="string")if(a==="OpenTabFromPreview")return l(h);else if(a==="CloseReplyPreview")return b("bs_curry")._1(k,void 0);else return},closeTab:function(a){},messages:r,hasContent:d,changeRepliedToMessage:j[1],repliedToMessage:j[0],buildSharedMediaViewerURL:m,closeReplyPreview:function(a){return b("bs_curry")._1(o,function(a){})},onSendMessage:l,isOptimisticThread:a,isLoading:n})}),fallback:null})}e={make:l};function a(a){var c=a.previewThreadID,d=a.isTabFocused,e=a.isFetching,f=a.hasContent,g=a.tokens,h=a.openTabForUser,m=a.openTabForGroup,n=a.openTabForPage;a=a.empty;a=a!==void 0?b("bs_caml_option").valFromOption(a):null;return i.jsxs(i.Fragment,{children:[i.jsx(b("MWChatConnectionStatusCard.bs").make,{}),e?null:c!==void 0?i.jsx(b("MWThread_DEPRECATED.bs").make,{id:c,children:i.jsx(b("MWThreadKey.bs").make,{id:b("MWThread_DEPRECATED.bs").toThreadKey(c),children:i.jsx(b("MWUIChatTabState.bs").Provider.make,{tab:{_0:c},children:i.jsx(k,{children:i.jsx(l,{isTabFocused:d,hasContent:f,openTabForGroup:m,openTabForUser:h,openTabForPage:n}),threadId:c})})})}):g.length!==0?i.jsx(b("MWUIChatTabState.bs").Provider.make,{tab:0,tokenProvider:function(a){return g.map(function(a){return a.getRawData().id})},children:i.jsx(j,{tokens:g,hasContent:f,isTabFocused:d,openTabForGroup:m})}):a]})}var m=b("bs_belt_Option").getWithDefault,n=b("MWChatTabContentStyles.bs").styles,o=10;a=a;f.$pipe$question=m;f.contentStyles=n;f.ComposerToCreateNewThread=c;f.ExistingThreadPreviewContainer=d;f.maxMessageCountForPreview=o;f.ExistingThreadPreview=e;f.make=a}),null);
__d("LSGroupMembershipMemberCell.bs",["fbt","ix","CometLazyPopoverTrigger.react","CometMiddot.react","CurrentEnvironment","FBID.bs","JSResource","LSContactBlockedByViewerStatus.bs","MWListCell.bs","TetraListCell.react","XCometMessengerControllerRouteBuilder","bs_caml_int64","bs_caml_option","bs_curry","bs_int64","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||b("react");function a(a){var c=a.thread,d=a.participant,e=a.contact,f=a.showAdminIndicator,i=a.cellRef,k=b("CurrentEnvironment").facebookdotcom?b("XCometMessengerControllerRouteBuilder").buildURL({thread_key:b("FBID.bs").ofStringExn(b("bs_int64").to_string(e.a))}):"/t/"+(b("bs_int64").to_string(e.a)+"/");a=d.f;a=a!==void 0?a:!1;var l=b("bs_caml_int64").neq(e.n,b("LSContactBlockedByViewerStatus.bs").unblocked),m;if(f)m=a?g._("Admin"):null;else{var n=d.g;m=n!==void 0?n:null}var o=[l?g._("Blocked"):null,l&&(f?a:d.g!==void 0)?j.jsx(b("CometMiddot.react"),{},"middot"):null,m],p=o.some(function(a){return a!==null});return j.jsx(b("CometLazyPopoverTrigger.react"),{popoverResource:b("JSResource")("LSGroupMembershipMenu.react").__setRef("LSGroupMembershipMemberCell.bs"),popoverProps:{onClose:function(a){},thread:c,participant:d,contact:e},popoverType:"menu",align:"end",preloadTrigger:"button",children:function(a,c,d,f,l,m,n){d={headline:e.h,addOnPrimary:{addOn:void 0,shape:"circle",size:36,source:{uri:e.b},alt:e.h,linkProps:{url:k},type:"profile-photo"},addOnSecondaryRef:a,addOnSecondary:b("MWListCell.bs").SecondaryAddOn.icon({"aria-label":g._("Card drop-down menu"),color:"secondary",icon:b("fbicon")._(h("484388"),24),onHoverOut:function(a){return b("bs_curry")._1(l,void 0)},onHoverIn:b("bs_curry").__1(f),onPress:function(a){return b("bs_curry")._1(c,void 0)},onPressIn:b("bs_curry").__1(m),type:"icon"}),level:4};n=p?b("bs_caml_option").some(j.jsx(j.Fragment,{children:o})):void 0;n!==void 0&&(d.body=b("bs_caml_option").valFromOption(n));i!==void 0&&(d.ref=b("bs_caml_option").valFromOption(i));return j.jsx(b("TetraListCell.react"),d)}})}c=a;f.make=c}),null);
__d("LSGroupMembershipMemberList.bs",["LSGroupMembershipMemberCell.bs","ReQL.bs","ReQLSubscription.bs","ReStore.bs","SkytaleDB","bs_int64","react"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=a.thread,d=a.showAdminsOnly,e=a.showAdminIndicator,f=b("ReStore.bs").useHook(void 0);a=b("ReQLSubscription.bs").useArray(h.useMemo(function(){return b("ReQL.bs").mergeJoin(b("ReQL.bs").getKeyRange(b("SkytaleDB").table(f,"participants").asc,{hd:c.a,tl:0}),b("SkytaleDB").table(f,"contacts").asc)},[f,JSON.stringify(c.a)]));a=a.slice(0).sort(function(a,b){return b[1].o-a[1].o});d=d?a.filter(function(a){a=a[0].f;if(a!==void 0)return a;else return!1}):a;return d.map(function(a){var d=a[1];return h.jsx(b("LSGroupMembershipMemberCell.bs").make,{thread:c,participant:a[0],contact:d,showAdminIndicator:e},b("bs_int64").to_string(d.a))})}c=a;f.make=c}),null);
__d("LSContactIdType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=b("bs_caml_int64").mk(2,0);f.unknown=a;f.fbid=c;f.smsLocalId=d}),null);
__d("LSContactViewerRelationship.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";c=(a=b("bs_caml_int64")).zero;d=a.one;e=a.mk(2,0);b=a.mk(3,0);a=a.mk(4,0);f.unknown=c;f.notContact=d;f.contactOfViewer=e;f.facebookFriend=b;f.softContact=a}),null);
__d("MWV2OnAuthoritativeThreadInsert.bs",["LSAuthorityLevel.bs","ReQL.bs","SkytaleDB","SortedAsyncIterable.bs","bs_caml_int64","bs_curry"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){c=b("SkytaleDB").table(c,"threads").index("clientThreadKey");c=c.asc;a=a[0];var e={contents:function(a){}};e.contents=b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").getKeyRange(c,{hd:a,tl:0}),function(a,c){if(typeof c==="number")return;a=c._0;if(b("bs_caml_int64").eq(a.Z,b("LSAuthorityLevel.bs").authoritative)){b("bs_curry")._1(d,a);return b("bs_curry")._1(e.contents,void 0)}})}f.onAuthoritativeThreadInsert=a}),null);
__d("MWThreadPreview.bs",["CometProgressRingIndeterminate.react","FBID.bs","LS.bs","LSAuthorityLevel.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactVerifyContactRowExistsStoredProcedure","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSInt64.bs","LSMailboxLocalCreateOptimisticGroupThreadStoredProcedure","LSMailboxVerifyThreadRowExistsStoredProcedure","LSMessagingThreadTypeUtil.bs","LSTransaction.bs","LSVec.bs","MWChatConnectionStatusCard.bs","MWChatTabNew.bs","MWLSActor.bs","MWThreadKey.bs","MWThread_DEPRECATED.bs","MWUIChatTabState.bs","MWV2OnAuthoritativeThreadInsert.bs","MessengerWebEvent","MessengerWebStgTypedLoggerLite.bs","Promise","ReQL.bs","ReQLSubscription.bs","ReQLSuspense.bs","ReStore.bs","SkytaleDB","bs_caml_format","bs_caml_option","bs_curry","bs_int64","bs_js_null_undefined","promiseDone","react","stylex"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react"),j={spinner:{display:"j83agx80",alignItems:"bp9cbjyn",justifyContent:"taijpn5t",flexGrow:"buofh1pr"},threadPreviewContainer:{display:"j83agx80",flexBasis:"rj1gh0hx",flexDirection:"cbu4d94t",flexGrow:"buofh1pr",fontSize:"jq4qci2q",zIndex:"du4w35lb"}},k=i.createContext({hasContent:{contents:!1},isTabFocused:!1,onBeforeOpenTabForGroup:function(a){},openTabForUser:function(a){},openTabForGroup:function(a){},openTabForPage:function(a){},submitted:!1});function l(a){var c=a.children,d=a.hasContent,e=a.isTabFocused,f=a.onBeforeOpenTabForGroup,g=a.openTabForUser,h=a.openTabForGroup;a=a.openTabForPage;var j=i.useState(function(){return!1}),l=j[1],m=i.useCallback(function(a){b("bs_curry")._1(l,function(a){return!0});return b("bs_curry")._1(f,void 0)},[l,f]);j=j[0];d={hasContent:d,isTabFocused:e,onBeforeOpenTabForGroup:m,openTabForUser:g,openTabForGroup:h,openTabForPage:a,submitted:j};return i.createElement(k.Provider,{value:d,children:c})}c={make:l};function m(a){var c=a.thread;a=c.a;var d=c.O,e=d!==void 0?b("LSInt64.bs").string(d)===b("LSInt64.bs").string(a):!1;d=b("LSMessagingThreadTypeUtil.bs").isGroup(a)||e?{NAME:"Group",VAL:b("FBID.bs").ofStringExn(b("bs_int64").to_string(a))}:{NAME:"User",VAL:b("FBID.bs").ofStringExn(b("bs_int64").to_string(a))};var f=i.useContext(k),g=f.submitted,l=f.openTabForGroup,m=f.onBeforeOpenTabForGroup,n=i.useCallback(function(a){b("bs_curry")._1(m,void 0);if(!e)return b("bs_curry")._1(l,a)},[l,e,m]);i.useEffect(function(){var a=c.O;a!==void 0&&g&&b("bs_int64").to_string(a)!==b("bs_int64").to_string(c.a)&&b("bs_curry")._1(l,b("FBID.bs").ofStringExn(b("bs_int64").to_string(c.a)))},[c,l,g]);return i.jsx("div",{className:(h||(h=b("stylex")))(j.threadPreviewContainer),children:i.jsx(b("MWThread_DEPRECATED.bs").make,{id:d,children:i.jsx(b("MWThreadKey.bs").make,{id:a,children:i.jsx(b("MWUIChatTabState.bs").Provider.make,{tab:{_0:d},children:i.jsx(b("MWChatTabNew.bs").ExistingThreadPreview.make,{isTabFocused:f.isTabFocused,hasContent:f.hasContent,openTabForGroup:n,openTabForUser:f.openTabForUser,openTabForPage:f.openTabForPage,isOptimisticThread:e})})})})})}d={make:m};function n(a){var c=a.threadKey,d=a.threadType,e=b("ReStore.bs").useHook(void 0);i.useEffect(function(){b("promiseDone")(b("LSTransaction.bs").run(e,function(a){return b("LSMailboxVerifyThreadRowExistsStoredProcedure")(b("bs_caml_format").caml_int64_of_string(c),d,b("LS.bs").make(a))},"readWrite"),void 0,void 0)},[e,c,d]);a=b("ReQLSubscription.bs").useFirst(i.useMemo(function(){return b("ReQL.bs").getKeyRange(b("SkytaleDB").table(e,"threads").asc,{hd:b("bs_caml_format").caml_int64_of_string(c),tl:0})},[e,c]));if(a!==void 0)return i.jsx(m,{thread:a});else return i.jsx("div",{className:(h||(h=b("stylex")))(j.spinner),children:i.jsx(b("CometProgressRingIndeterminate.react"),{color:"disabled",size:24})})}e={make:n};function o(a){var c=a.tokens,d=a.tokenContactIds,e=b("ReStore.bs").useHook(void 0),f=b("bs_int64").to_string(b("MWLSActor.bs").useActor(void 0)),g=b("ReQLSubscription.bs").useArray(i.useMemo(function(){return b("ReQL.bs").map(b("ReQL.bs").filter(b("SkytaleDB").table(e,"participants").asc,function(a){return d.has(b("bs_int64").to_string(a.b))}),function(a){return b("bs_int64").to_string(a.a)})},[e,d])),k=b("ReQLSubscription.bs").useFirst(i.useMemo(function(){var a=new Set(g);return b("ReQL.bs").filter(b("ReQL.bs").filter(b("ReQL.bs").filter(b("SkytaleDB").table(e,"threads").asc,function(a){return a.d===void 0}),function(c){c=c.O;if(c!==void 0)return a.has(b("bs_int64").to_string(c));else return!1}),function(a){a=a.O;if(a===void 0)return!1;a=b("ReQLSuspense.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("SkytaleDB").table(e,"participants").index("threadKeyReadWatermarkTimestampMs").desc,{hd:a,tl:0}),function(a){return b("bs_int64").to_string(a.b)}),function(a){return a!==f}));if(a.every(function(a){return d.has(a)}))return a.length===d.size;else return!1})},[e,g,d,f])),l=i.useCallback(function(a){return b("LSTransaction.bs").run(e,function(c){return b("LSMailboxLocalCreateOptimisticGroupThreadStoredProcedure")(b("LSVec.bs").make(a),void 0,b("LS.bs").make(c))},"readWrite")},[e]),n=function(a){return b("MessengerWebStgTypedLoggerLite.bs").log({event_name:b("MessengerWebEvent").CREATE_THREAD,thread_fbid:b("bs_js_null_undefined").fromOption(b("FBID.bs").ofString(b("bs_int64").to_string(a.a)))})};i.useEffect(function(){if(k===void 0){var a=b("bs_curry")._1(l,c.map(function(a){return b("bs_caml_format").caml_int64_of_string(a.b)}));a.then(function(a){b("MWV2OnAuthoritativeThreadInsert.bs").onAuthoritativeThreadInsert(a,e,n);return b("Promise").resolve(void 0)})}},[e,c,k]);if(k!==void 0)return i.jsx(m,{thread:k});else return i.jsx("div",{className:(h||(h=b("stylex")))(j.spinner),children:i.jsx(b("CometProgressRingIndeterminate.react"),{color:"disabled",size:24})})}var p={make:o};function q(a){var c=a.tokens,d=b("ReStore.bs").useHook(void 0),e=b("bs_int64").to_string(b("MWLSActor.bs").useActor(void 0)),f=i.useMemo(function(){return new Set(c.map(function(a){return a.b}))},[c]),g=b("ReQLSubscription.bs").useArray(i.useMemo(function(){return b("ReQL.bs").map(b("ReQL.bs").filter(b("SkytaleDB").table(d,"participants").asc,function(a){return f.has(b("bs_int64").to_string(a.b))}),function(a){return b("bs_int64").to_string(a.a)})},[d,f]));a=b("ReQLSubscription.bs").useFirst(i.useMemo(function(){var a=new Set(g);return b("ReQL.bs").filter(b("ReQL.bs").filter(b("ReQL.bs").filter(b("SkytaleDB").table(d,"threads").asc,function(a){return a.d===void 0}),function(c){return a.has(b("bs_int64").to_string(c.a))}),function(a){a=b("ReQLSuspense.bs").toArray(b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("SkytaleDB").table(d,"participants").index("threadKeyReadWatermarkTimestampMs").desc,{hd:a.a,tl:0}),function(a){return b("bs_int64").to_string(a.b)}));var c=a.filter(function(a){return a!==e});if(a.length===c.length||c.length!==f.size)return!1;else return c.every(function(a){return f.has(a)})})},[d,g,f,e]));i.useEffect(function(){c.forEach(function(a){b("LSTransaction.bs").run(d,function(c){return b("LSContactVerifyContactRowExistsStoredProcedure")(b("bs_caml_format").caml_int64_of_string(a.b),b("LSContactIdType.bs").fbid,a.g,a.f,b("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,a.l,void 0,!1,b("LSAuthorityLevel.bs").clientPartial,void 0,b("LSContactWorkForeignEntityType.bs").unknown,b("LSContactGender.bs").unknown,b("LSContactViewerRelationship.bs").unknown,void 0,b("LS.bs").make(c))},"readWrite")})},[d,f]);if(a!==void 0)return i.jsx(m,{thread:a});else return i.jsx(o,{tokens:c,tokenContactIds:f})}var r={make:q};function a(a){var c=a.tokens,d=a.hasContent,e=a.isTabFocused,f=a.onBeforeOpenTabForGroup,g=a.openTabForUser,h=a.openTabForGroup,j=a.openTabForPage;a=a.empty;d=d!==void 0?d:{contents:!0};e=e!==void 0?e:!0;f=f!==void 0?f:function(a){};a=a!==void 0?b("bs_caml_option").valFromOption(a):null;var k=b("bs_int64").to_string(b("MWLSActor.bs").useActor(void 0)),m=i.useMemo(function(){var a=[];c.forEach(function(b){b=b.getServerSearchResult();if(b!==void 0){a.push(b);return}});return a},[c]),o,p=0,r=m.length;if(r>=3)p=1;else switch(r){case 0:o=a;break;case 1:r=m[0];o=i.jsx(n,{threadKey:r.b,threadType:r.e});break;case 2:a=m[0];r=m[1];a.b===k?o=i.jsx(n,{threadKey:r.b,threadType:r.e}):r.b===k?o=i.jsx(n,{threadKey:a.b,threadType:a.e}):p=1;break}p===1&&(o=i.jsx(q,{tokens:m.filter(function(a){return a.b!==k})}));return i.jsxs(l,{children:[i.jsx(b("MWChatConnectionStatusCard.bs").make,{}),o],hasContent:d,isTabFocused:e,onBeforeOpenTabForGroup:f,openTabForUser:g,openTabForGroup:h,openTabForPage:j})}a=a;f.styles=j;f.context=k;f.MWThreadPreviewContextProvider=c;f.ThreadPreview=d;f.OneOnOnePreview=e;f.GroupPreviewOptimistic=p;f.GroupPreview=r;f.make=a}),null);